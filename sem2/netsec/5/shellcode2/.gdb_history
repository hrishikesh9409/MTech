list 0
b 8
b 9
r AAAAA
x/20wx $esp
x/20wx $esp
n
x/20wx $esp
c
clear
r $(cat shellcode)
c
c
r $(cat shellcode)
x/20wx $esp
r $(cat shellcode)
x/20wx $esp
n
n
n
clear
c
clear
r $(cat shellcode)
x/20wx $esp
q
b 7
b 8
b 9
r $(cat shellcode)
x/20wx $esp
n
x/20wx $esp
n
x/20wx $esp
n
n
n
n
n
q
q
b 8
b 9
r AAAA
x/20wx $esp
q
r $(cat shellcode)
r $(cat shellcode)
q
r $(cat shellcode)
r $(cat shellcode)
b 8
b 9
r $(cat shellcode)
n
n
x/20wx $esp
exit
q
b 8
b 9
r $(cat shellcode)
n
x/20wx $esp
n
exit
q
r $(cat shellcode)
b 8
b 9
r $(cat shellcode)
x/20wx $esp
q
b 8
b 9
r $(cat shellcode)
p &buf
c
c
r $(cat shellcode)
b 8
b 9
list 0
q
list 0
b 8
b 9
r $(cat shellcode)
n
x/20wx $esp
q
disass main
b 0x0804847a
b "0x0804847a"
b *0x0804847a
r
exit
q
disass
disass main
b *0x0804847a
r shellcode
c
r
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
c
exit
q
q
disass main
b *0x0804847a
r
list 0
q
disass main
b *0x0804847a
r AAAAAAAAAAAAA
c
r AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
c
r AAAAAAAAAAAAAAAAAAAAAAAAAA
c
x/20w $esp
r shellcode
x/20w $esp
si
si
si
si
si
si
si
si
si
x/20w $esp
si
si
si
si
si
si
ni
si
si
si
si
ni
x/20w $esp
q
disass main
b *0x0804847a
disass vuln_fun 
b *0x0804844d
clear
r shellcode
si
si
si
si
si
si
si
si
si
q
b main
disass main
b *0x0804847a
disass vuln_fun 
b *0x0804844d
r $(cat shellcode)
c
c
si
si
si
si
si
si
ni
si
si
si
si
x/20w $esp
si
ni
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
q
disass vuln_fun 
b *0x08048473
r $(cat shellcode)
ni
x/20w $esp
si
x/40w $esp
r $(cat shellcode)
ni
x/40w $esp
c
x/40w $esp
q
list 0
q
list 0
disassemble vuln_fun
b *0x0804844d
r shellcode 
si
si
si
x/20w $esp
disass main
b *0x0804847a
r
si
si
q
