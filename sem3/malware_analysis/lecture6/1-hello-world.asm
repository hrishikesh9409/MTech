;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                                                                              ;
; Author    :   Arvind                                                         ;
; Date      :   30/07/2017                                                     ;
; Program   :   print "Hello world" using printf                               ;
; Note      :   This program was tested on Ubuntu 16.04 64 bit using           ;
;               nasm 2.11.08 and gcc 5.4.0 multilib.                           ;
;                                                                              ;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

BITS 32

extern printf                        ; declare that printf is defined elsewhere

section .rodata                             ; start of data section
    hello_world: db "Hello, world!", 10, 0  ; string we wish to print out

section .text                               ; start of text section
	global main
	
    main:
        push ebp                            ; set up main's stack frame
        mov ebp, esp                        ; on top of it's caller's frame

        push hello_world                    ; set only argument to printf
        call printf                         ; and invoke it.

        mov eax, 0                          ; set return value
        mov esp, ebp                        ; destroy main's stack frame and
        pop ebp                             ; restore main's caller's stack frame
        ret                                 ; return to main's caller
